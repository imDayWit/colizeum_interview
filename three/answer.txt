Вопрос:

Представим есть высоконагруженное веб-приложение, написанное на фреймворке
Django. Необходимо в одну из моделей добавить новое поле (например,
"status") с
дефолтным значением (например,
"1"). Таблица связанная с моделью активно
используется (чтение/запись) и содержит огромное кол-во записей (~ 1млн.).
Необходимо описать процесс добавления нового поля и дефолтного значения таким
образом, чтобы не нарушить работу приложения (не блокировать таблицу надолго, не
останавливать приложение, не переключать бд/сервера).

Ответ:
К примеру мы хотим дефолтно иметь значение 1 (default=1)

Вариант 1:
1. Добавить новое поле без дефолтного значения и с null, например
new_field = IntegerField(null=True)
2. Создаем и выполняем миграцию
3. Создаем скрипт для обновления поля new_field на 1 батчами по N объектов и запускаем его (через manage.py, celery task или миграции пункта 2)
4. После того, как обновление данных батчами было полностью выполнено - создаем вторую миграцию с указанием default, например
new_field = IntegerField(default=1)

Вариант 2:
Если имеются реплики БД (при высокой нагржуенности БД, да и в проде в целом частая практика иметь реплики):
1. На реплике добавляем новое поле
new_field = IntegerField(default=1)
2. Выполняем миграцию
3. Переключаем приложение на реплику
4. Выполняем миграцию на мейн БД
5. Переключаем приложение обратно